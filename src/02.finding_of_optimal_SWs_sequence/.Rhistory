setwd('/home/tkoutsandreas/Projects/MASLD/project/new_git_version/MASLD---Continuous-trajectory-approach/src/02.finding_of_optimal_SWs_sequence/')
sorted_samples_filename <- "../../data/ucam_sanyal/PC1_sorted_samples.csv"
sorted_samples_df = read.table(sorted_samples_filename, sep=',', header=TRUE)
View(sorted_samples_df)
View(sorted_samples_df)
####
# 2. Samples metadata, the column name os samples and the important batches that
# should be taken into account in differential expression analysis. This names
# column will be used as id for the samples, in order to match them with the
# respective entries in counts matrix.
####
template_filename <- "../../data/ucam_sanyal/metadata.csv"
sorted_samples_filename <- "../../data/ucam_sanyal/PC1_sorted_samples.csv"
sorted_samples_df = read.table(sorted_samples_filename, sep=',', header=TRUE)
# Should be like:
#               X          pc1         pc2
#1   GSM3998327  -27.58061891 -0.76788978
#2   GSM3998301  -20.61404364  1.22527002
#3   GSM3998258  -18.34908949 -0.98698704
#4   GSM3998188  -18.27205652  0.91769042
#5   GSM3998332  -17.39840662 -1.22990361
#
rownames(sorted_samples_df) = sorted_samples_df[,1]
sorted_samples_df[,1] = NULL
sorted_samples_df[,2] = rownames(sorted_samples_df)
colnames(sorted_samples_df) <- c('Sorting_axis', 'Sample_name')
template_df = read.csv(file = template_filename, sep=',')
View(template_df)
View(template_df)
batches <- c("Sex", "Gender")
template_df = read.csv(file = template_filename, sep=',')
rownames(template_df) = template_df[,sample_names_col]
####
# 2. Samples metadata, the column name os samples and the important batches that
# should be taken into account in differential expression analysis. This names
# column will be used as id for the samples, in order to match them with the
# respective entries in counts matrix.
####
template_filename <- "../../data/ucam_sanyal/metadata.csv"
sample_names_col <- 'Sample.name'
batches <- c("Sex", "Gender")
template_df = read.csv(file = template_filename, sep=',')
rownames(template_df) = template_df[,sample_names_col]
template_df <- template_df[rownames(sorted_samples_df),]
####
# 3. Counts matrix. Sample names should be the same as in metadata file.
####
counts_filename <- "../../data/ucam_sanyal/counts_matrix.csv"
rownames_col <- NULL
counts_matrix_df <- read.csv(file = counts_filename, sep = ",")
if (is.null(rownames_col)) {
# pass
} else {
rownames(counts_matrix_df) = as.character(counts_matrix_df[,rownames_col])
counts_matrix_df[,rownames_col] = NULL
}
counts_matrix_df <- counts_matrix_df[, rownames(sorted_samples_df)]
counts_matrix_df <- counts_matrix_df[(rowSums(counts_matrix_df)>dim(counts_matrix_df)[2]),] #Exclude low expressed counts
####
# 3. Counts matrix. Sample names should be the same as in metadata file.
####
counts_filename <- "../../data/ucam_sanyal/counts_matrix.csv"
rownames_col <- NULL
counts_matrix_df <- read.csv(file = counts_filename, sep = ",")
if (is.null(rownames_col)) {
# pass
} else {
rownames(counts_matrix_df) = as.character(counts_matrix_df[,rownames_col])
counts_matrix_df[,rownames_col] = NULL
}
sorted_samples_df
rownames(sorted_samples_df)
counts_matrix_df <- counts_matrix_df[, rownames(sorted_samples_df)]
rownames(template_df)
rownames_col
####
# 3. Counts matrix. Sample names should be the same as in metadata file.
####
counts_filename <- "../../data/ucam_sanyal/counts_matrix.csv"
counts_matrix_df <- read.csv(file = counts_filename, sep = ",")
if (is.null(rownames_col)) {
# pass
} else {
rownames(counts_matrix_df) = as.character(counts_matrix_df[,rownames_col])
counts_matrix_df[,rownames_col] = NULL
}
counts_matrix_df <- counts_matrix_df[, rownames(sorted_samples_df)]
as.character(counts_matrix_df[,rownames_col])
rownames(counts_matrix_df)
####
# 3. Counts matrix. Sample names should be the same as in metadata file.
####
counts_filename <- "../../data/ucam_sanyal/counts_matrix.csv"
counts_matrix_df <- read.csv(file = counts_filename, sep = ",")
View(counts_matrix_df)
rownames(sorted_samples_df)
rownames(counts_matrix_df) = as.character(counts_matrix_df$X)
counts_matrix_df = counts_matrix_df[,-c(1)]
counts_matrix_df <- counts_matrix_df[, rownames(sorted_samples_df)]
rownames(sorted_samples_df)
colnames(counts_matrix_df)
gsub('.', ' ', colnames(counts_matrix_df))
gsub('\\.', ' ', colnames(counts_matrix_df))
####
# 3. Counts matrix. Sample names should be the same as in metadata file.
####
counts_filename <- "../../data/ucam_sanyal/counts_matrix.csv"
counts_matrix_df <- read.csv(file = counts_filename, sep = ",")
rownames(counts_matrix_df) = as.character(counts_matrix_df$X)
counts_matrix_df = counts_matrix_df[,-c(1)]
colnames(counts_matrix_df) <- gsub('\\.', ' ', colnames(counts_matrix_df))
counts_matrix_df <- counts_matrix_df[, rownames(sorted_samples_df)]
counts_matrix_df <- counts_matrix_df[(rowSums(counts_matrix_df)>dim(counts_matrix_df)[2]),] #Exclude low expressed counts
counts_matrix = data.matrix(counts_matrix_df)
colnames(counts_matrix) == row.names(template_df)
output_dir <- '../../results/ucam_sanyal/finding_of_optimal_SWs_sequence/'
sorted_samples_filename <- "../../data/ucam_sanyal/PC1_sorted_samples.csv"
sorted_samples_df = read.table(sorted_samples_filename, sep=',', header=TRUE)
rownames(sorted_samples_df) = sorted_samples_df[,1]
sorted_samples_df[,1] = NULL
sorted_samples_df[,2] = rownames(sorted_samples_df)
colnames(sorted_samples_df) <- c('Sorting_axis', 'Sample_name')
directories <- c('sw_graph_6_15_02', 'sw_graph_8_17_025', 'sw_graph_8_24_03',
'sw_graph_10_20_03', 'sw_graph_12_25_035')
sorted_samples_df
