print(paste(database, module))
gene_set = modules_gene_sets[[module]]
res = execute_fisher_exact_test(gene_set, annotation_list, TRUE,
modules_background)
res$module = rep(module, dim(res)[1])
res$database = rep(database, dim(res)[1])
res$tf <- rownames(res)
rownames(res) <- NULL
# STATISTICAL THRESHOLD 0.05 TO DEFINE THE ENRICHED TFS
res = res[res$adj_p.value < 0.05,]
if (dim(res)[1] > 0) {
tfs_enrichment <- rbind(tfs_enrichment, res)
} else {
#pass without recording
}
}
}
suppressMessages(library(dplyr)) # 1.1.2
suppressMessages(library(data.table)) # 1.14.18 rbindlist
suppressMessages(library(rlang)) # 1.1.3 duplicate
source("../library.R")
tfs_enrichment <- data.frame()
for (database in databases) {
annotation_list <- annotation_lists[[database]]
for (module in modules) {
print(paste(database, module))
gene_set = modules_gene_sets[[module]]
res = execute_fisher_exact_test(gene_set, annotation_list, TRUE,
modules_background)
res$module = rep(module, dim(res)[1])
res$database = rep(database, dim(res)[1])
res$tf <- rownames(res)
rownames(res) <- NULL
# STATISTICAL THRESHOLD 0.05 TO DEFINE THE ENRICHED TFS
res = res[res$adj_p.value < 0.05,]
if (dim(res)[1] > 0) {
tfs_enrichment <- rbind(tfs_enrichment, res)
} else {
#pass without recording
}
}
}
output_df <- duplicate(tfs_enrichment)
output_df <- output_df[!grepl('mouse', output_df$tf),]
output_df$tf <- unlist(lapply(strsplit(output_df$tf, " "), head, n = 1L))
rownames(output_df) <- NULL
colnames <- c('tf', 'module', 'database', 'p.value', 'adj_p.value', 'overlap', "odds_ratio")
output_df <- output_df[, colnames]
dir.create(output_dir, recursive = TRUE, showWarnings = FALSE)
write.table(output_df, paste(output_dir, 'tfs_enrichment.tsv', sep=''), sep='\t',
quote = FALSE, row.names = FALSE)
################################################################################
#
# 1. Input arguments
#
################################################################################
main_dir = '../../results_epos2/wgcna_and_linear_modelling/grid_params/4_300/'
output_dir <- '../../results_epos2/enrichment_analysis/'
#main_dir = '../../results_ucam_sanyal/wgcna_and_linear_modelling/grid_params/4_180/'
#output_dir <- '../../results_ucam_sanyal/enrichment_analysis/'
################################################################################
#
# 2. Loading of linear regression results for gene co-expression modules.
# Modules with FDR < 0.05, at least in one model, will be kept as significant.
#
# Additionally their filtered gene content is retrieved, in order to define the
# background gene set for the enrichment analysis.
#
################################################################################
coefs_df <- read.table(paste(main_dir, 'module_variable_coefficients_FINAL.tsv', sep=''),
sep='\t', header=TRUE)
coefs_df <- coefs_df[coefs_df$p.value_adjust<0.05,] # STATISTICAL THRESHOLD 0.05 FOR THE MODULES
coefs_df <- coefs_df[!coefs_df$term %in% c('age', 'inflammation'),]
modules <- unique(coefs_df$term)
modules_df <- read.table(paste(main_dir, 'filtered_modules.tsv',sep=''), sep='\t', header=TRUE)
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
modules_background <- unique(unname(unlist(modules_gene_sets)))
################################################################################
#
# 3. Loading of the TF-regulon databases and execution of enrichment analysis
# using the fisher exact function (filtering with FDR < 0.05).
#
################################################################################
load('../../data/annotation_databases/annotation_lists.RData')
databases <- c(
"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X",
"Transcription_Factor_PPIs",
"TRANSFAC_and_JASPAR_PWMs",
"COLLECTRI"
)
tfs_enrichment <- data.frame()
for (database in databases) {
annotation_list <- annotation_lists[[database]]
for (module in modules) {
print(paste(database, module))
gene_set = modules_gene_sets[[module]]
res = execute_fisher_exact_test(gene_set, annotation_list, TRUE,
modules_background)
res$module = rep(module, dim(res)[1])
res$database = rep(database, dim(res)[1])
res$tf <- rownames(res)
rownames(res) <- NULL
# STATISTICAL THRESHOLD 0.05 TO DEFINE THE ENRICHED TFS
res = res[res$adj_p.value < 0.05,]
if (dim(res)[1] > 0) {
tfs_enrichment <- rbind(tfs_enrichment, res)
} else {
#pass without recording
}
}
}
################################################################################
#
# 4. Modification of the enrichment analysis results and saving them as a data
# frame.
#
################################################################################
output_df <- duplicate(tfs_enrichment)
output_df <- output_df[!grepl('mouse', output_df$tf),]
output_df$tf <- unlist(lapply(strsplit(output_df$tf, " "), head, n = 1L))
rownames(output_df) <- NULL
colnames <- c('tf', 'module', 'database', 'p.value', 'adj_p.value', 'overlap', "odds_ratio")
output_df <- output_df[, colnames]
dir.create(output_dir, recursive = TRUE, showWarnings = FALSE)
write.table(output_df, paste(output_dir, 'tfs_enrichment.tsv', sep=''), sep='\t',
quote = FALSE, row.names = FALSE)
################################################################################
#
# 1. Input arguments
#
################################################################################
main_dir = '../../results_epos/wgcna_and_linear_modelling/grid_params/4_300/'
output_dir <- '../../results_epos/enrichment_analysis/'
#main_dir = '../../results_ucam_sanyal/wgcna_and_linear_modelling/grid_params/4_180/'
#output_dir <- '../../results_ucam_sanyal/enrichment_analysis/'
################################################################################
#
# 2. Loading of linear regression results for gene co-expression modules.
# Modules with FDR < 0.05, at least in one model, will be kept as significant.
#
# Additionally their filtered gene content is retrieved, in order to define the
# background gene set for the enrichment analysis.
#
################################################################################
coefs_df <- read.table(paste(main_dir, 'module_variable_coefficients_FINAL.tsv', sep=''),
sep='\t', header=TRUE)
coefs_df <- coefs_df[coefs_df$p.value_adjust<0.05,] # STATISTICAL THRESHOLD 0.05 FOR THE MODULES
coefs_df <- coefs_df[!coefs_df$term %in% c('age', 'inflammation'),]
modules <- unique(coefs_df$term)
modules_df <- read.table(paste(main_dir, 'filtered_modules.tsv',sep=''), sep='\t', header=TRUE)
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
modules_background <- unique(unname(unlist(modules_gene_sets)))
################################################################################
#
# 3. Loading of the TF-regulon databases and execution of enrichment analysis
# using the fisher exact function (filtering with FDR < 0.05).
#
################################################################################
load('../../data/annotation_databases/annotation_lists.RData')
databases <- c(
"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X",
"Transcription_Factor_PPIs",
"TRANSFAC_and_JASPAR_PWMs",
"COLLECTRI"
)
tfs_enrichment <- data.frame()
for (database in databases) {
annotation_list <- annotation_lists[[database]]
for (module in modules) {
print(paste(database, module))
gene_set = modules_gene_sets[[module]]
res = execute_fisher_exact_test(gene_set, annotation_list, TRUE,
modules_background)
res$module = rep(module, dim(res)[1])
res$database = rep(database, dim(res)[1])
res$tf <- rownames(res)
rownames(res) <- NULL
# STATISTICAL THRESHOLD 0.05 TO DEFINE THE ENRICHED TFS
res = res[res$adj_p.value < 0.05,]
if (dim(res)[1] > 0) {
tfs_enrichment <- rbind(tfs_enrichment, res)
} else {
#pass without recording
}
}
}
################################################################################
#
# 4. Modification of the enrichment analysis results and saving them as a data
# frame.
#
################################################################################
output_df <- duplicate(tfs_enrichment)
output_df <- output_df[!grepl('mouse', output_df$tf),]
output_df$tf <- unlist(lapply(strsplit(output_df$tf, " "), head, n = 1L))
rownames(output_df) <- NULL
colnames <- c('tf', 'module', 'database', 'p.value', 'adj_p.value', 'overlap', "odds_ratio")
output_df <- output_df[, colnames]
dir.create(output_dir, recursive = TRUE, showWarnings = FALSE)
write.table(output_df, paste(output_dir, 'tfs_enrichment.tsv', sep=''), sep='\t',
quote = FALSE, row.names = FALSE)
################################################################################
#
# 1. Input arguments
#
################################################################################
#main_dir = '../../results_epos/wgcna_and_linear_modelling/grid_params/4_300/'
#output_dir <- '../../results_epos/enrichment_analysis/'
main_dir = '../../results_ucam_sanyal/wgcna_and_linear_modelling/grid_params/4_180/'
output_dir <- '../../results_ucam_sanyal/enrichment_analysis/'
################################################################################
#
# 2. Loading of linear regression results for gene co-expression modules.
# Modules with FDR < 0.05, at least in one model, will be kept as significant.
#
# Additionally their filtered gene content is retrieved, in order to define the
# background gene set for the enrichment analysis.
#
################################################################################
coefs_df <- read.table(paste(main_dir, 'module_variable_coefficients_FINAL.tsv', sep=''),
sep='\t', header=TRUE)
coefs_df <- coefs_df[coefs_df$p.value_adjust<0.05,] # STATISTICAL THRESHOLD 0.05 FOR THE MODULES
coefs_df <- coefs_df[!coefs_df$term %in% c('age', 'inflammation'),]
modules <- unique(coefs_df$term)
modules_df <- read.table(paste(main_dir, 'filtered_modules.tsv',sep=''), sep='\t', header=TRUE)
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
modules_background <- unique(unname(unlist(modules_gene_sets)))
################################################################################
#
# 3. Loading of the TF-regulon databases and execution of enrichment analysis
# using the fisher exact function (filtering with FDR < 0.05).
#
################################################################################
load('../../data/annotation_databases/annotation_lists.RData')
databases <- c(
"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X",
"Transcription_Factor_PPIs",
"TRANSFAC_and_JASPAR_PWMs",
"COLLECTRI"
)
tfs_enrichment <- data.frame()
for (database in databases) {
annotation_list <- annotation_lists[[database]]
for (module in modules) {
print(paste(database, module))
gene_set = modules_gene_sets[[module]]
res = execute_fisher_exact_test(gene_set, annotation_list, TRUE,
modules_background)
res$module = rep(module, dim(res)[1])
res$database = rep(database, dim(res)[1])
res$tf <- rownames(res)
rownames(res) <- NULL
# STATISTICAL THRESHOLD 0.05 TO DEFINE THE ENRICHED TFS
res = res[res$adj_p.value < 0.05,]
if (dim(res)[1] > 0) {
tfs_enrichment <- rbind(tfs_enrichment, res)
} else {
#pass without recording
}
}
}
################################################################################
#
# 4. Modification of the enrichment analysis results and saving them as a data
# frame.
#
################################################################################
output_df <- duplicate(tfs_enrichment)
output_df <- output_df[!grepl('mouse', output_df$tf),]
output_df$tf <- unlist(lapply(strsplit(output_df$tf, " "), head, n = 1L))
rownames(output_df) <- NULL
colnames <- c('tf', 'module', 'database', 'p.value', 'adj_p.value', 'overlap', "odds_ratio")
output_df <- output_df[, colnames]
dir.create(output_dir, recursive = TRUE, showWarnings = FALSE)
write.table(output_df, paste(output_dir, 'tfs_enrichment.tsv', sep=''), sep='\t',
quote = FALSE, row.names = FALSE)
################################################################################
#
# 1. Input arguments
#
################################################################################
#main_dir = '../../results_epos/wgcna_and_linear_modelling/grid_params/4_300/'
#output_dir <- '../../results_epos/enrichment_analysis/'
main_dir = '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/'
output_dir <- '../../results_ucam_sanyal2/enrichment_analysis/'
################################################################################
#
# 2. Loading of linear regression results for gene co-expression modules.
# Modules with FDR < 0.05, at least in one model, will be kept as significant.
#
# Additionally their filtered gene content is retrieved, in order to define the
# background gene set for the enrichment analysis.
#
################################################################################
coefs_df <- read.table(paste(main_dir, 'module_variable_coefficients_FINAL.tsv', sep=''),
sep='\t', header=TRUE)
coefs_df <- coefs_df[coefs_df$p.value_adjust<0.05,] # STATISTICAL THRESHOLD 0.05 FOR THE MODULES
coefs_df <- coefs_df[!coefs_df$term %in% c('age', 'inflammation'),]
modules <- unique(coefs_df$term)
modules_df <- read.table(paste(main_dir, 'filtered_modules.tsv',sep=''), sep='\t', header=TRUE)
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
modules_background <- unique(unname(unlist(modules_gene_sets)))
################################################################################
#
# 3. Loading of the TF-regulon databases and execution of enrichment analysis
# using the fisher exact function (filtering with FDR < 0.05).
#
################################################################################
load('../../data/annotation_databases/annotation_lists.RData')
databases <- c(
"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X",
"Transcription_Factor_PPIs",
"TRANSFAC_and_JASPAR_PWMs",
"COLLECTRI"
)
tfs_enrichment <- data.frame()
for (database in databases) {
annotation_list <- annotation_lists[[database]]
for (module in modules) {
print(paste(database, module))
gene_set = modules_gene_sets[[module]]
res = execute_fisher_exact_test(gene_set, annotation_list, TRUE,
modules_background)
res$module = rep(module, dim(res)[1])
res$database = rep(database, dim(res)[1])
res$tf <- rownames(res)
rownames(res) <- NULL
# STATISTICAL THRESHOLD 0.05 TO DEFINE THE ENRICHED TFS
res = res[res$adj_p.value < 0.05,]
if (dim(res)[1] > 0) {
tfs_enrichment <- rbind(tfs_enrichment, res)
} else {
#pass without recording
}
}
}
################################################################################
#
# 4. Modification of the enrichment analysis results and saving them as a data
# frame.
#
################################################################################
output_df <- duplicate(tfs_enrichment)
output_df <- output_df[!grepl('mouse', output_df$tf),]
output_df$tf <- unlist(lapply(strsplit(output_df$tf, " "), head, n = 1L))
rownames(output_df) <- NULL
colnames <- c('tf', 'module', 'database', 'p.value', 'adj_p.value', 'overlap', "odds_ratio")
output_df <- output_df[, colnames]
dir.create(output_dir, recursive = TRUE, showWarnings = FALSE)
write.table(output_df, paste(output_dir, 'tfs_enrichment.tsv', sep=''), sep='\t',
quote = FALSE, row.names = FALSE)
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/04.deseq_and_msviper/02.msviper_and_transformation_of_results.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/04.deseq_and_msviper/02.msviper_and_transformation_of_results.R")
source("~/Projects/MASLD/project/src/04.deseq_and_msviper/02.msviper_and_transformation_of_results.R")
source("~/Projects/MASLD/project/src/04.deseq_and_msviper/02.msviper_and_transformation_of_results.R")
source("~/Projects/MASLD/project/src/04.deseq_and_msviper/02.msviper_and_transformation_of_results.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
input_dir = '../../results_ucam_sanyal2/de_and_tf_analysis/'
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
main_dir = '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/'
output_dir <- '../../results_ucam_sanyal2/enrichment_analysis/'
################################################################################
#
# 2. Loading of linear regression results for gene co-expression modules.
# Modules with FDR < 0.05, at least in one model, will be kept as significant.
#
# Additionally their filtered gene content is retrieved, in order to define the
# background gene set for the enrichment analysis.
#
################################################################################
coefs_df <- read.table(paste(main_dir, 'module_variable_coefficients_FINAL.tsv', sep=''),
sep='\t', header=TRUE)
coefs_df <- coefs_df[coefs_df$p.value_adjust<0.05,] # STATISTICAL THRESHOLD 0.05 FOR THE MODULES
coefs_df <- coefs_df[!coefs_df$term %in% c('age', 'inflammation'),]
modules <- unique(coefs_df$term)
modules
modules_df <- read.table(paste(main_dir, 'filtered_modules.tsv',sep=''), sep='\t', header=TRUE)
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
modules_background <- unique(unname(unlist(modules_gene_sets)))
length(modules_background)
head(modules_df)
source("~/Projects/MASLD/project/src/05.enrichment_analysis/01.tfs_enrichment_analysis.R")
output_dir <- '../../results_ucam_sanyal/enrichment_analysis/'
source("~/Projects/MASLD/project/src/05.enrichment_analysis/01.tfs_enrichment_analysis.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/01.tfs_enrichment_analysis.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/01.tfs_enrichment_analysis.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/02.reactome_enrichment_analysis_of_enriched_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
source("~/Projects/MASLD/project/src/05.enrichment_analysis/03.reactome_enrichment_analysis_of_diff_activated_tfs.R")
suppressMessages(library(dplyr)) # 1.1.2
suppressMessages(library(tidyr)) # 1.3.0
suppressMessages(library(OmnipathR)) # 3.8.0
suppressMessages(library(PCSF)) # 0.99.1
suppressMessages(library(igraph)) # 1.4.3
suppressMessages(library(GOSemSim))
modules_dir = '../../results_ucam_sanyal/wgcna_and_linear_modelling/grid_params/4_180/'
output_dir = '../../results_ucam_sanyal/networks/'
tmp_output_dir = '../../results_ucam_sanyal/networks/MASLD_network_construction/'
dir.create(tmp_output_dir, showWarnings = FALSE)
modules_dir = '../../results_ucam_sanyal/wgcna_and_linear_modelling/grid_params/4_180/'
output_dir = '../../results_ucam_sanyal/networks/'
tmp_output_dir = '../../results_ucam_sanyal/networks/MASLD_network_construction/'
dir.create(tmp_output_dir, showWarnings = FALSE)
load('../../data/reference_network.RData')
# A. Loading of the GE module gene sets.
modules_df <- read.table(paste(modules_dir, 'filtered_modules.tsv',sep=''),
sep='\t', header=TRUE)
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
# B. Loading of the coefficients from lm(variable ~ modules) models. Statistical
# significance at 0.05 (removal of age & inflammation from the independent variables).
filename <- paste(modules_dir, 'module_variable_coefficients_FINAL.tsv', sep='')
modules_per_var_df <- read.table(filename, sep='\t', header=TRUE)
modules_per_var_df <- modules_per_var_df[modules_per_var_df$p.value_adjust < 0.05,]
modules_per_var_df <- modules_per_var_df[!modules_per_var_df$term %in% c('age', 'inflammation'),]
modules_per_var <- sapply(unique(modules_per_var_df$variable), function(var) {
modules_per_var_df[modules_per_var_df$variable == var, 'term']
}, USE.NAMES = TRUE)
length(modules_gene_sets)
# C. Creation of the "module_sets_per_var" list to save the GE module gene sets.
module_sets_per_var <- sapply(unique(modules_per_var_df$variable), function(var) {
var_modules <- modules_per_var[[var]]
gene_set <- c()
for (module in var_modules) {
gene_set <- c(gene_set, modules_gene_sets[[module]])
}
unique(gene_set)
}, USE.NAMES = TRUE)
print('length of filtered module gene sets:')
print(lengths(module_sets_per_var))
modules_dir = '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/'
output_dir = '../../results_ucam_sanyal2/networks/'
tmp_output_dir = '../../results_ucam_sanyal2/networks/MASLD_network_construction/'
dir.create(tmp_output_dir, showWarnings = FALSE)
load('../../data/reference_network.RData')
################################################################################
#
# 2. Creation of a list for the module gene sets of MASLD variables. Initially,
# the gene co-expression (GE) module gene sets and their coefficients
# from the linear models are loaded from the respective tab-delimited files.
# The most significant GE modules (FDR < 0.05) for each MASLD variable are
# selected and their gene sets are saved into the "module_sets_per_var" list.
#
################################################################################
# A. Loading of the GE module gene sets.
modules_df <- read.table(paste(modules_dir, 'filtered_modules.tsv',sep=''),
sep='\t', header=TRUE)
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
# B. Loading of the coefficients from lm(variable ~ modules) models. Statistical
# significance at 0.05 (removal of age & inflammation from the independent variables).
filename <- paste(modules_dir, 'module_variable_coefficients_FINAL.tsv', sep='')
modules_per_var_df <- read.table(filename, sep='\t', header=TRUE)
modules_per_var_df <- modules_per_var_df[modules_per_var_df$p.value_adjust < 0.05,]
modules_per_var_df <- modules_per_var_df[!modules_per_var_df$term %in% c('age', 'inflammation'),]
modules_per_var <- sapply(unique(modules_per_var_df$variable), function(var) {
modules_per_var_df[modules_per_var_df$variable == var, 'term']
}, USE.NAMES = TRUE)
# C. Creation of the "module_sets_per_var" list to save the GE module gene sets.
module_sets_per_var <- sapply(unique(modules_per_var_df$variable), function(var) {
var_modules <- modules_per_var[[var]]
gene_set <- c()
for (module in var_modules) {
gene_set <- c(gene_set, modules_gene_sets[[module]])
}
unique(gene_set)
}, USE.NAMES = TRUE)
print('length of filtered module gene sets:')
print(lengths(module_sets_per_var))
module_genes <- unique(unlist(module_sets_per_var, use.names = FALSE))
length(module_genes)
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/02.create_MASLD_networks_without_semantics.R")
getwd()
setwd("/home/tkoutsandreas/Projects/MASLD/project/src/06.create_MASLD_network/")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/06.create_MASLD_networks_with_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/06.create_MASLD_networks_with_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/06.create_MASLD_networks_with_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/06.create_MASLD_networks_with_semantics.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/07.unify_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/07.unify_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/07.unify_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/07.unify_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/07.unify_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/08.laplacian_normalization_of_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/08.laplacian_normalization_of_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/08.laplacian_normalization_of_MASLD_networks.R")
source("~/Projects/MASLD/project/src/06.create_MASLD_network/08.laplacian_normalization_of_MASLD_networks.R")
