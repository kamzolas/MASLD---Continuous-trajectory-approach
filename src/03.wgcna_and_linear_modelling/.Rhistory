gc()
gc()
library(scran)
help(modelGeneVar)
# Fisher.exact test
a11 <- 57 # genes both term set and sample
a12 <- 65 # genes in term set but not in sample
a21 <- 12 # genes not in term set but in sample
a22 <- 1052 # all the other genes
contigency_table <- matrix(c(a11, a21, a12, a22), nrow = 2)
test <- fisher.test(x=contigency_table, alternative='greater', or=1)
test
# Fisher.exact test
a11 <- 57 # genes both term set and sample
a12 <- 65 # genes in term set but not in sample
a21 <- 70 # genes not in term set but in sample
a22 <- 1052 # all the other genes
contigency_table <- matrix(c(a11, a21, a12, a22), nrow = 2)
test <- fisher.test(x=contigency_table, alternative='greater', or=1)
test
# Fisher.exact test
a11 <- 57 # genes both term set and sample
a12 <- 65 # genes in term set but not in sample
a21 <- 12 # genes not in term set but in sample
a22 <- 1052 # all the other genes
contigency_table <- matrix(c(a11, a21, a12, a22), nrow = 2)
test <- fisher.test(x=contigency_table, alternative='greater', or=1)
test
setwd('/home/tkoutsandreas/Projects/MASLD/project/src/03.wgcna_and_linear_modelling/')
coefs_df <- read.table(paste(main_dir, 'module_variable_coefficients_FINAL.tsv', sep=''),
sep='\t', header=TRUE)
coefs_df <- read.table(paste('module_variable_coefficients_FINAL.tsv', sep=''),
sep='\t', header=TRUE)
filename <- '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/module_variable_coefficients_FINAL.tsv'
coefs_df <- read.table(filename, sep='\t', header=TRUE)
coefs_df <- coefs_df[coefs_df$p.value_adjust<0.05,] # STATISTICAL THRESHOLD 0.05 FOR THE MODULES
coefs_df <- coefs_df[!coefs_df$term %in% c('age', 'inflammation'),]
modules <- unique(coefs_df$term)
modules
modules_df <- read.table(paste(main_dir, 'filtered_modules.tsv',sep=''), sep='\t', header=TRUE)
modules_df <- modules_df[modules_df$module_color %in% modules,]
filename <-  '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/filtered_modules.tsv'
modules_df <- read.table(flename, sep='\t', header=TRUE)
filename <-  '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/filtered_modules.tsv'
modules_df <- read.table(filename, sep='\t', header=TRUE)
modules_df <- modules_df[modules_df$module_color %in% modules,]
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
lengths(modules_gene_sets)
filename <-  '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/filtered_modules.tsv'
modules_df <- read.table(filename, sep='\t', header=TRUE)
modules_df <- modules_df[modules_df$module_color %in% modules,]
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
lengths(modules_gene_sets)
filename <-  '../../results_ucam_sanyal2/wgcna_and_linear_modelling/grid_params/4_180/modules.tsv'
modules_df <- read.table(filename, sep='\t', header=TRUE)
modules_df <- modules_df[modules_df$module_color %in% modules,]
modules_gene_sets <- split(x=modules_df$gene_symbol, f=modules_df$module_color)
lengths(modules_gene_sets)
library(GOSemSim)
