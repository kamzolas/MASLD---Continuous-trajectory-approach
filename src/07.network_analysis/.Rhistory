setwd("/home/tkoutsandreas/Projects/MASLD/project/src/07.network_analysis/")
source("~/Projects/MASLD/project/src/07.network_analysis/01.create_the_initial_weights.R")
source("~/Projects/MASLD/project/src/07.network_analysis/01.create_the_initial_weights.R")
source("~/Projects/MASLD/project/src/07.network_analysis/01.create_the_initial_weights.R")
source("~/Projects/MASLD/project/src/07.network_analysis/01.create_the_initial_weights.R")
getwd()
main_dir = paste('../../results_epos/networks/', sep='')
tmp_dir1 = paste(main_dir, 'network_analysis/propagation_results/', sep='')
tmp_dir2 = paste(main_dir, 'network_analysis/consensus_propagation_signatures/', sep='')
files <- list.files(paste(main_dir, 'network_analysis/propagation_results/', sep=''))
files <- files[grepl('.RData', files)]
files
load(paste(main_dir, 'MASLD_unified_undirected_network_with_semantics.RData', sep=''))
network <- MASLD_unified_undirected_network
file <- files[1]
file
tmp <- strsplit(x=file, split = '\\.')[[1]][1]
param <- paste(strsplit(x=tmp, split = '-')[[1]][1], strsplit(x=tmp, split = '-')[[1]][2], sep='-')
damping <- strsplit(x=tmp, split = '-')[[1]][3]
filename <- paste(tmp_dir1, file, sep='')
load(filename)
tmp_signatures <- list()
directions <- c('up', 'down')
for (sw in names(propagation_results)) {
for (direction in directions) {
pvalues_df <- propagation_results[[sw]][[direction]][['pvalues']]
nodes_df <- pvalues_df[pvalues_df$pvalue < 0.05,,drop=FALSE]
propagated_nodes <- rownames(nodes_df)
tmp_signatures[[sw]][[direction]]<- propagated_nodes
}
}
View(pvalues_df)
View(pvalues_df)
propagation_signatures <- list()
propagation_pvalues <- list()
for (file in files) {
tmp <- strsplit(x=file, split = '\\.')[[1]][1]
param <- paste(strsplit(x=tmp, split = '-')[[1]][1], strsplit(x=tmp, split = '-')[[1]][2], sep='-')
damping <- strsplit(x=tmp, split = '-')[[1]][3]
filename <- paste(tmp_dir1, file, sep='')
load(filename)
tmp_signatures <- list()
directions <- c('up', 'down')
for (sw in names(propagation_results)) {
for (direction in directions) {
pvalues_df <- propagation_results[[sw]][[direction]][['pvalues']]
propagation_pvalues[[sw]][[direction]] <- pvalues_df
nodes_df <- pvalues_df[pvalues_df$pvalue < 0.05,,drop=FALSE]
propagated_nodes <- rownames(nodes_df)
tmp_signatures[[sw]][[direction]]<- propagated_nodes
}
}
propagation_signatures[[param]][[damping]] <- tmp_signatures
}
propagation_signatures <- list()
propagation_pvalues <- list()
for (file in files) {
tmp <- strsplit(x=file, split = '\\.')[[1]][1]
param <- paste(strsplit(x=tmp, split = '-')[[1]][1], strsplit(x=tmp, split = '-')[[1]][2], sep='-')
damping <- strsplit(x=tmp, split = '-')[[1]][3]
filename <- paste(tmp_dir1, file, sep='')
load(filename)
tmp_signatures <- list()
directions <- c('up', 'down')
for (sw in names(propagation_results)) {
for (direction in directions) {
pvalues_df <- propagation_results[[sw]][[direction]][['pvalues']]
tmp_pvalues[[sw]][[direction]] <- pvalues_df
nodes_df <- pvalues_df[pvalues_df$pvalue < 0.05,,drop=FALSE]
propagated_nodes <- rownames(nodes_df)
tmp_signatures[[sw]][[direction]]<- propagated_nodes
}
}
propagation_signatures[[param]][[damping]] <- tmp_signatures
propagation_pvalues[[param]][[damping]] <- tmp_pvalues
}
propagation_signatures <- list()
propagation_pvalues <- list()
for (file in files) {
tmp <- strsplit(x=file, split = '\\.')[[1]][1]
param <- paste(strsplit(x=tmp, split = '-')[[1]][1], strsplit(x=tmp, split = '-')[[1]][2], sep='-')
damping <- strsplit(x=tmp, split = '-')[[1]][3]
filename <- paste(tmp_dir1, file, sep='')
load(filename)
tmp_signatures <- list()
tmp_pvalues <- list()
directions <- c('up', 'down')
for (sw in names(propagation_results)) {
for (direction in directions) {
pvalues_df <- propagation_results[[sw]][[direction]][['pvalues']]
tmp_pvalues[[sw]][[direction]] <- pvalues_df
nodes_df <- pvalues_df[pvalues_df$pvalue < 0.05,,drop=FALSE]
propagated_nodes <- rownames(nodes_df)
tmp_signatures[[sw]][[direction]]<- propagated_nodes
}
}
propagation_signatures[[param]][[damping]] <- tmp_signatures
propagation_pvalues[[param]][[damping]] <- tmp_pvalues
}
View(propagation_pvalues)
View(propagation_pvalues)
final_signatures <- list()
final_signatures_json <- list()
for (param in names(propagation_signatures)) {
tmp_signatures <- list()
for (damping in names(propagation_signatures[[param]])){
tmp <- propagation_signatures[[param]][[damping]]
for (sw in names(tmp)) {
tmp_signatures[[sw]][['up']] <- c(tmp_signatures[[sw]][['up']], tmp[[sw]][['up']])
tmp_signatures[[sw]][['down']] <- c(tmp_signatures[[sw]][['down']], tmp[[sw]][['down']])
}
}
for (sw in names(tmp_signatures)) {
# Unify and filter the up_genes
up_counts <- table(tmp_signatures[[sw]][['up']])
up_genes <- names(up_counts[up_counts == 3])
propagated_network <- induced_subgraph(network, vids=up_genes, impl="create_from_scratch")
detected_components <- components(propagated_network)
components <- which(detected_components$csize >=3)
component_nodes <- names(detected_components$membership[detected_components$membership %in% components])
propagated_network <- induced_subgraph(propagated_network, vids=component_nodes,
impl="create_from_scratch")
final_signatures[[param]][[sw]][['up']][['genes_signature']] <- component_nodes
final_signatures[[param]][[sw]][['up']][['subnetwork']] <- propagated_network
final_signatures_json[[param]][[sw]][['up']] <- component_nodes
# Unify and filter the down_genes
down_counts <- table(tmp_signatures[[sw]][['down']])
down_genes <- names(down_counts[down_counts == 3])
propagated_network <- induced_subgraph(network, vids=down_genes, impl="create_from_scratch")
detected_components <- components(propagated_network)
components <- which(detected_components$csize >=3)
component_nodes <- names(detected_components$membership[detected_components$membership %in% components])
propagated_network <- induced_subgraph(propagated_network, vids=component_nodes,
impl="create_from_scratch")
final_signatures[[param]][[sw]][['down']][['genes_signature']] <- component_nodes
final_signatures[[param]][[sw]][['down']][['subnetwork']] <- propagated_network
final_signatures_json[[param]][[sw]][['down']] <- component_nodes
}
}
names(final_signatures)
propagation_signatures <- names(final_signatures)[["random_sw-lapl_norm_weight"]]
propagation_signatures <- final_signatures[["random_sw-lapl_norm_weight"]]
View(propagation_signatures)
View(propagation_signatures)
for (sw in names(propagation_signatures)) {
signature <- propagation_signatures[[sw]][['up']]
}
signature
signature <- propagation_signatures[[sw]][['up']]$genes_signature
signature
names(propagation_pvalues)
propagation_pvalues[[param]][[0.85]]
names(propagation_pvalues[[param]])
names(propagation_pvalues[[param]])[['085']])
names(propagation_pvalues[[param]][['085']])
df <- propagation_pvalues[[param]][['085']][[sw]]
df
dfs <- c()
df <- propagation_pvalues[[param]][['085']][[sw]]
dfs <- cbind(dfs, df)
df <- propagation_pvalues[[param]][['07']][[sw]]
dfs <- cbind(dfs, df)
View(dfs)
View(dfs)
df <- propagation_pvalues[[param]][['07']][[sw]][['up']]
df
dfs <- c()
df <- propagation_pvalues[[param]][['07']][[sw]][['up']]
dfs <- cbind(dfs, df)
df1 <- propagation_pvalues[[param]][['085']][[sw]][['up']]
df2 <- propagation_pvalues[[param]][['07']][[sw]][['up']]
df3 <- propagation_pvalues[[param]][['05']][[sw]][['up']]
df <- cbind(df1, df2, df3)
View(df)
View(df)
head(df1)
head(df2)
head(df3)
df1['DDR2',]
df2['DDR2',]
df3['DDR2',]
df3['SPON2',]
df3['SPON1',]
df2['SPON1',]
df3['SPON1',]
df1['SPON1',]
df <- merge(df1, df2, by.x = 0, by.y=0)
df <- merge(df, df3, by.x = 0, by.y=0)
df
df1 <- propagation_pvalues[[param]][['085']][[sw]][['up']]
df2 <- propagation_pvalues[[param]][['07']][[sw]][['up']]
df <- merge(df1, df2, by.x = 0, by.y=0)
df
df1["AQP3",]
df2["AQP3",]
rownames(df) <- df$Row.names
df$Row.names <- NULL
df3 <- propagation_pvalues[[param]][['05']][[sw]][['up']]
df <- merge(df, df3, by.x = 0, by.y=0)
rownames(df) <- df$Row.names
df$Row.names <- NULL
df1['A2M',]
df2['A2M',]
df3['A2M',]
df3['CHEBI:29108',]
df2['CHEBI:29108',]
df1['CHEBI:29108',]
df1['ENG',]
df2['ENG',]
df3['ENG',]
df <- df[signature,]
dim(df)
df <- -log10(df+0.001)
df <- rowMeans(df)
sw_signatures <- propagation_signatures[[sw]]
names(sw_signatures)
sw_signatures[['up']]
help("data.frame")
help(Reduce)
df1 <- propagation_pvalues[[param]][['085']][[sw]][['up']]
df2 <- propagation_pvalues[[param]][['07']][[sw]][['up']]
df3 <- propagation_pvalues[[param]][['05']][[sw]][['up']]
df <- Reduce(merge, c(df1, df2, df3))
df
df1 <-
df2 <-
df3 <-
tmp_list <- list(propagation_pvalues[[param]][['085']][[sw]][['up']],
propagation_pvalues[[param]][['07']][[sw]][['up']],
propagation_pvalues[[param]][['05']][[sw]][['up']])
df <- Reduce(function(x, y) merge(x, y, by.x=0, by.y=0, all=TRUE), tmp_list)
dim(df)
head(df)
df <- Reduce(function(x, y) merge(x, y, all=TRUE), tmp_list)
head(df)
library(tidyverse)
tmp_list <- list(propagation_pvalues[[param]][['085']][[sw]][['up']],
propagation_pvalues[[param]][['07']][[sw]][['up']],
propagation_pvalues[[param]][['05']][[sw]][['up']])
help(merge)
transform
help(transform)
df <- Reduce(function(x, y) transform(merge(x, y, all=TRUE),
row.names=rownames(tmp_list[[1]]), Row.names=NULL),
tmp_list)
tmp_list[[1]]
head(transform)
help(transform)
df1
df <- merge(df1, df2, by.x=0, by.y=0, all=TRUE)
head(df)
df <- transform(merge(df1, df2, by.x=0, by.y=0, all=TRUE), row.names='Row.names')
head(df)
tmp_list <- list(propagation_pvalues[[param]][['085']][[sw]][['up']],
propagation_pvalues[[param]][['07']][[sw]][['up']],
propagation_pvalues[[param]][['05']][[sw]][['up']])
df1 <- tmp_list[[1]]
df2 <- tmp_list[[2]]
df <- transform(merge(df1, df2, by.x=0, by.y=0, all=TRUE), row.names='Row.names')
head(df)
df <- Reduce(function(x,y) transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'))
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
head(df)
tmp_list[[1]]['AAAS',]
tmp_list[[2]]['AAAS',]
tmp_list[[3]]['AAAS',]
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
df <- -log10(df+0.001)
df <- rowMeans(df)
columns(df) <- c('weight')
head(df)
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
View(df)
View(df)
df <- -log10(df+0.001)
df <- rowMeans(df)
columns(df) <- c('weight')
class(df)
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
class(df)
df <- -log10(df+0.001)
class(df)
df <- rowMeans(df)
class(df)
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
df <- -log10(df+0.001)
df <- as.data.frame(rowMeans(df))
class(df)
columns(df) <- c('weight')
class(df)
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
df <- -log10(df+0.001)
df <- as.data.frame(rowMeans(df))
colnames(df) <- c('weight')
df[df < 0]=0
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
df <- -log10(df+0.001)
df[df < 0] = 0
df <- as.data.frame(rowMeans(df))
View(df)
View(df)
colnames(df) <- c('weight')
View(df)
View(df)
directions = c('up', 'down')
direction_pvalues_list <- list()
for (direction in directions) {
for (sw in names(propagation_signatures)) {
tmp_list <- list(propagation_pvalues[[param]][['085']][[sw]][[direction]],
propagation_pvalues[[param]][['07']][[sw]][[direction]],
propagation_pvalues[[param]][['05']][[sw]][[direction]])
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
df <- -log10(df+0.001)
df[df < 0] = 0
df <- as.data.frame(rowMeans(df))
colnames(df) <- c(sw)
direction_pvalues_list[[sw]] <- df
}
names(direction_pvalues_list)
D
asdas
dsa
asd
as\)
directions = c('up', 'down')
direction_pvalues_list <- list()
for (direction in directions) {
for (sw in names(propagation_signatures)) {
tmp_list <- list(propagation_pvalues[[param]][['085']][[sw]][[direction]],
propagation_pvalues[[param]][['07']][[sw]][[direction]],
propagation_pvalues[[param]][['05']][[sw]][[direction]])
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
df <- -log10(df+0.001)
df[df < 0] = 0
df <- as.data.frame(rowMeans(df))
colnames(df) <- c(sw)
direction_pvalues_list[[sw]] <- df
}
}
names(direction_pvalues_list)
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
direction_pvalues_list)
log10(0.05)
getwd()
source("~/Projects/MASLD/project/src/07.network_analysis/03.unify_and_filter_network_propagation_results.R")
source("~/Projects/MASLD/project/src/07.network_analysis/03.unify_and_filter_network_propagation_results.R")
tmp_dir2
df
direction <- 'up'
direction_pvalues_list <- list()
for (sw in names(propagation_signatures)) {
tmp_list <- list(propagation_pvalues[[param]][['085']][[sw]][[direction]],
propagation_pvalues[[param]][['07']][[sw]][[direction]],
propagation_pvalues[[param]][['05']][[sw]][[direction]])
df <- Reduce(function(x,y)
transform(merge(x, y, by.x=0, by.y=0, all=TRUE), row.names='Row.names'),
tmp_list)
df <- -log10(df+0.001)
df[df < 0] = 0
df <- as.data.frame(rowMeans(df))
colnames(df) <- c(sw)
direction_pvalues_list[[sw]] <- df
}
direction_pvalues_list[['SW2']]
df = direction_pvalues_list[['SW2']]
View(df)
View(df)
df = direction_pvalues_list[['SW13']]
View(df)
View(df)
source("~/Projects/MASLD/project/src/07.network_analysis/03.unify_and_filter_network_propagation_results.R")
source("~/Projects/MASLD/project/src/07.network_analysis/03.unify_and_filter_network_propagation_results.R")
source("~/Projects/MASLD/project/src/07.network_analysis/03.unify_and_filter_network_propagation_results.R")
source("~/Projects/MASLD/project/src/07.network_analysis/04.enrichment_analysis_of_consensus_propagation_signatures.R")
source("~/Projects/MASLD/project/src/07.network_analysis/04.enrichment_analysis_of_consensus_propagation_signatures.R")
source("~/Projects/MASLD/project/src/07.network_analysis/04.enrichment_analysis_of_consensus_propagation_signatures.R")
source("~/Projects/MASLD/project/src/07.network_analysis/04.enrichment_analysis_of_consensus_propagation_signatures.R")
source("~/Projects/MASLD/project/src/07.network_analysis/05.enrichment_analysis_of_all_genes_in_signatures.R")
source("~/Projects/MASLD/project/src/07.network_analysis/05.enrichment_analysis_of_all_genes_in_signatures.R")
source("~/Projects/MASLD/project/src/07.network_analysis/05.enrichment_analysis_of_all_genes_in_signatures.R")
source("~/Projects/MASLD/project/src/07.network_analysis/05.enrichment_analysis_of_all_genes_in_signatures.R")
